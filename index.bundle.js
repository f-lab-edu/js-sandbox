(()=>{"use strict";var e="/js-sandbox/";const t=new class{db;constructor(e,t,n){this.dbName=e,this.dbVersion=t,this.stores=n}async openDB(){return new Promise(((e,t)=>{const n=window.indexedDB.open(this.dbName,this.dbVersion);n.onsuccess=()=>{this.db=n.result,e()},n.onerror=e=>{t(e)},n.onupgradeneeded=()=>{this.db=n.result,this.stores.forEach((e=>{this.db.objectStoreNames.contains(e)&&this.db.deleteObjectStore(e),this.db.createObjectStore(e,{keyPath:"id",autoIncrement:!0})}))}}))}async getData(e,t){return new Promise(((n,i)=>{const s=this.db.transaction(e,"readonly").objectStore(e).get(t);s.onsuccess=()=>{n(s.result)},s.onerror=e=>{i(e)}}))}async getAllData(e){return new Promise(((t,n)=>{const i=this.db.transaction(e,"readonly").objectStore(e).getAll();i.onsuccess=()=>{t(i.result)},i.onerror=e=>{n(e)}}))}async upsertData(e,t){return new Promise(((n,i)=>{const s=this.db.transaction(e,"readwrite").objectStore(e).put(t);s.onsuccess=()=>{n(s.result)},s.onerror=e=>{i(e)}}))}async deleteData(e,t){return new Promise(((n,i)=>{const s=this.db.transaction(e,"readwrite").objectStore(e).delete(t);s.onsuccess=()=>{n(s.result)},s.onerror=e=>{i(e)}}))}}("sandboxDB",2,["notepad"]),n=(e,...t)=>String.raw(e,...t);class i extends HTMLElement{connectedCallback(){this.render()}render(){this.innerHTML=this.injectHTML()}injectHTML(){return""}}class s extends i{injectHTML(){return n`
      <div id="page"></div>
      <my-icons tabindex="-1"></my-icons>
      <my-footer></my-footer>
    `}}const a=e+"2a583f97b153f7da7d41.png",l=[{path:"/",html:n`<my-home></my-home>`,label:"Home",iconSrc:null},{path:"/tetris",html:n`<my-tetris></my-tetris>`,label:"Tetris",iconSrc:e+"71c0bea6462001116fcf.png"},{path:"/flappybird",html:n`<my-flappybird></my-flappybird>`,label:"Flappy&nbsp;Bird",iconSrc:e+"39b884119b49599495ed.png"},{path:"/notepad",html:n`<my-notepad></my-notepad>`,label:"Note&nbsp;Pad",iconSrc:a}],c=l.reduce(((e,t)=>{const{path:n,label:i,iconSrc:s}=t;return"/"===t.path?e:[...e,{path:n,label:i,iconSrc:s}]}),[]),o=async()=>[...(await t.getAllData("notepad")).reduce(((e,t)=>{const{id:n,title:i}=t;return[...e,{path:`/notepad/${n}`,label:i,iconSrc:a}]}),[])],r=l,d="/js-sandbox",h=new class{constructor(e){this.routes=e}render(){const e=this.routes.find((e=>e.path===window.location.pathname.replace(d,"")));e?document.querySelector("#page").innerHTML=e.html:this.replaceTo("/")}navigateTo(e){window.history.pushState(null,null,d+e),this.render()}replaceTo(e){window.history.replaceState(null,null,d+e),this.render()}back(){window.history.back(),this.render()}}(r),p=e+"59cb65e4f8f2627d6c2c.png",b=e+"bc8d31a2338dd0b3f68a.png";class u extends i{connectedCallback(){super.connectedCallback(),this.addEventListener("click",this.handleClick.bind(this))}injectHTML(){return n`
      <img alt="window_logo" src=${p} class="window_icon" />
      <div class="input_box">
        <img alt="search" src=${b} class="window_icon" /><input type="text" placeholder="Ï∞æÍ∏∞" />
      </div>
      ${c.map((e=>n` <my-icon data-path="${e.path}" data-iconSrc="${e.iconSrc}"></my-icon> `)).join("")}
    `}handleClick(e){if(!e.target.closest("my-icon"))return;const t=e.target.closest("my-icon");h.navigateTo(t.dataset.path)}}class y extends i{}class m extends i{injectHTML(){return n`
      <h1>Tetris</h1>
      <p>You are viewing the Tetris component!</p>
    `}}class k extends i{injectHTML(){return n`
      <h1>Flappy Bird</h1>
      <p>You are viewing the Flappy Bird component!</p>
      <p>You are viewing the Flappy Bird component!</p>
      <p>You are viewing the Flappy Bird component!</p>
      <p>You are viewing the Flappy Bird component!</p>
      <p>You are viewing the Flappy Bird component!</p>
      <p>You are viewing the Flappy Bird component!</p>
    `}}class v extends i{async connectedCallback(){this.icons=[...c,...await o()],super.connectedCallback(),this.addEventListener("click",this.handleClick.bind(this)),this.addEventListener("dblclick",this.handleDoubleClick.bind(this)),this.addEventListener("keydown",this.handleKeyDown.bind(this)),this.addEventListener("iconChange",(e=>{this.icons=[...this.icons,e.detail]}))}static get observedAttributes(){return["icons"]}attributeChangedCallback(e,t,n){t!==n&&this.render()}injectHTML(){return n`
      ${this.icons.map((e=>n`
            <my-icon data-path=${e.path} data-label=${e.label} data-iconSrc=${e.iconSrc}></my-icon>
          `)).join("")}
    `}get icons(){return JSON.parse(this.getAttribute("icons"))}set icons(e){this.setAttribute("icons",JSON.stringify(e))}handleClick(e){if(!e.target.closest("my-icon"))return;const t=e.target.closest("my-icon");t.toggleAttribute("checked"),this.querySelectorAll("my-icon").forEach((e=>{e!==t&&e.removeAttribute("checked")}))}handleDoubleClick(e){if(!e.target.closest("my-icon"))return;const t=e.target.closest("my-icon");h.navigateTo(t.dataset.path)}handleKeyDown(e){const t=this.querySelectorAll("my-icon[checked]");if("Enter"===e.key){if(t.length>1)return;if(!t)return;h.navigateTo(t[0].dataset.path)}}}class g extends i{injectHTML(){const{label:e,iconsrc:t}=this.dataset;return n`
      <img alt="${e}_icon" src=${t} />
      ${e?`<span class="icon_name">${e}</span>`:""}
    `}}class f extends i{connectedCallback(){super.connectedCallback(),this.addEventListener("save",this.handleSave),this.addEventListener("localSave",this.handleLocalSave)}disconnectedCallback(){this.removeEventListener("save",this.handleSave),this.removeEventListener("localSave",this.handleLocalSave)}injectHTML(){return n`
      <my-notepad-header></my-notepad-header>
      <textarea></textarea>
    `}handleLocalSave(){const e=this.getNotePadData();if("fail"!==e)try{const t=new Blob([e.content],{type:"text/plain"}),n=document.createElement("a");n.href=URL.createObjectURL(t),n.download=`${e.title}.txt`,n.click()}catch(e){alert("Ï†ÄÏû•Ïóê Ïã§Ìå®ÌñàÏäµÎãàÎã§."),console.error(e)}finally{this.querySelector("textarea").value=""}}async handleSave(e){e.stopPropagation();const n=this.getNotePadData();if("fail"!==n)try{const e=await t.upsertData("notepad",{title:n.title.replace(/ /g,"&nbsp;"),content:n.content.replace(/ /g,"&nbsp;").replace(/\n/g,"<br>").replace(/\t/g,"&nbsp;&nbsp;&nbsp;&nbsp;")});e&&alert("Ï†ÄÏû•ÎêòÏóàÏäµÎãàÎã§."),document.querySelector("my-icons").dispatchEvent(new CustomEvent("iconChange",{detail:{path:`/notepad/${e}`,label:n.title.replace(/ /g,"&nbsp;"),iconSrc:a}}))}catch(e){alert("Ï†ÄÏû•Ïóê Ïã§Ìå®ÌñàÏäµÎãàÎã§."),console.error(e)}finally{this.querySelector("textarea").value=""}}getNotePadData(){const e=this.querySelector("textarea").value;if(!e)return alert("ÎÇ¥Ïö©Ïù¥ ÏóÜÏäµÎãàÎã§."),"fail";let t=prompt("Ï†ÄÏû•Ìï† ÌååÏùºÎ™ÖÏùÑ ÏûÖÎ†•ÌïòÏÑ∏Ïöî","Ï†úÎ™©ÏóÜÏùå");for(;null==t||""===t;){if(null===t)return"fail";t=prompt("ÌååÏùºÎ™ÖÏùÄ ÌïÑÏàòÏûÖÎãàÎã§.","Ï†úÎ™©ÏóÜÏùå")}return{title:t,content:e}}}const w=[{id:"file",title:"ÌååÏùº",key:"F",slots:[{id:1,text:"ÏÉàÎ°ú ÎßåÎì§Í∏∞(N)",key:["Ctrl","N"],disable:!0},{id:2,text:"ÎÇ¥ Ïª¥Ìì®ÌÑ∞Ïóê Ï†ÄÏû•(W)",key:["Ctrl","Shift","N"],onClick:function(){this.dispatchEvent(new CustomEvent("localSave",{bubbles:!0}))}},{id:3,text:"Ï†ÄÏû•(S)",key:["Ctrl","S"],onClick:function(){this.dispatchEvent(new CustomEvent("save",{bubbles:!0}))}},{id:4,text:"ÏÇ≠Ï†ú(D)",key:["Ctrl","Shift","S"],disable:!0},{id:5,text:"ÌéòÏù¥ÏßÄ ÏÑ§Ï†ï(U)...",key:[],disable:!0},{id:6,text:"Ïù∏ÏáÑ(P)...",key:["Ctrl","P"],disable:!0},{id:7,text:"ÎÅùÎÇ¥Í∏∞(X)",key:[],disable:!0}]},{id:"edit",title:"Ìé∏Ïßë",key:"E",slots:[{id:8,text:"Ïã§Ìñâ Ï∑®ÏÜå(U)",key:["Ctrl","Z"],disable:!0},{id:9,text:"ÏûòÎùºÎÇ¥Í∏∞(T)",key:["Ctrl","X"],disable:!0},{id:10,text:"Î≥µÏÇ¨(C)",key:["Ctrl","C"],disable:!0},{id:11,text:"Î∂ôÏó¨ÎÑ£Í∏∞(P)",key:["Ctrl","V"],disable:!0},{id:12,text:"ÏÇ≠Ï†ú(D)",key:["Del"],disable:!0},{id:13,text:"BingÏúºÎ°ú Í≤ÄÏÉâ(S)...",key:["Ctrl","E"],disable:!0},{id:14,text:"Ï∞æÍ∏∞(F)...",key:["Ctrl","F"],disable:!0},{id:15,text:"Îã§Ïùå Ï∞æÍ∏∞(N)",key:["F3"],disable:!0},{id:16,text:"Ïù¥Ï†Ñ Ï∞æÍ∏∞(V)",key:["Shift","F3"],disable:!0},{id:17,text:"Î∞îÍæ∏Í∏∞(R)...",key:["Ctrl","H"],disable:!0},{id:18,text:"Ïù¥Îèô(G)...",key:["Ctrl","G"],disable:!0},{id:19,text:"Î™®Îëê ÏÑ†ÌÉù(A)",key:["Ctrl","A"],disable:!0},{id:20,text:"ÏãúÍ∞Ñ/ÎÇ†Ïßú(D)",key:["F5"],disable:!0}]},{id:"format",title:"ÏÑúÏãù",key:"O",slots:[{id:21,text:"ÏûêÎèô Ï§Ñ Î∞îÍøà(W)",key:[],disable:!0},{id:22,text:"Í∏ÄÍº¥(F)...",key:[],disable:!0}]},{id:"view",title:"Î≥¥Í∏∞",key:"V",slots:[{id:23,text:"ÌôïÎåÄÌïòÍ∏∞(Z)",key:["Ctrl","+"],disable:!0},{id:24,text:"Ï∂ïÏÜåÌïòÍ∏∞(X)",key:["Ctrl","-"],disable:!0},{id:25,text:"ÏÉÅÌÉú ÌëúÏãúÏ§Ñ(S)",key:[],disable:!0}]},{id:"help",title:"ÎèÑÏõÄÎßê",key:"H",slots:[{id:26,text:"ÎèÑÏõÄÎßê Î≥¥Í∏∞(H)",key:[],disable:!0},{id:27,text:"ÌîºÎìúÎ∞± Î≥¥ÎÇ¥Í∏∞(F)",key:[],disable:!0},{id:28,text:"Î©îÎ™®Ïû• Ï†ïÎ≥¥(A)",key:[],disable:!0}]}],x=w.reduce(((e,t)=>[...e,...t.slots]),[]),S=w;class C extends i{connectedCallback(){super.connectedCallback(),this.addEventListener("click",this.handleClick)}disconnectedCallback(){this.removeEventListener("click",this.handleClick)}injectHTML(){return n`
      <header>
        <span><img alt="notepad_icon" src=${a} />Ï†úÎ™©ÏóÜÏùå - Windows Î©îÎ™®Ïû•</span>
        <div class="view_buttons">
          <button class="view_button" id="mini">üóï</button>
          <button class="view_button" id="full">üóñ</button>
          <button class="view_button" id="close">‚Ö©</button>
        </div>
      </header>
      <div class="edit_buttons">
        ${S.map((e=>n`
              <button class="edit_button">
                ${e.title}(<u>${e.key}</u>)
                <div class="popup">
                  ${e.slots.map((e=>n`
                        <div class="sub" data-id="${e.id}" data-disable="${!!e.disable}">
                          <div>${e.text}</div>
                          ${e.key.length>0?`<div>${e.key.join(" + ")}</div>`:""}
                        </div>
                      `)).join("")}
                </div>
              </button>
            `)).join("")}
      </div>
    `}handleClick(e){const t=e.target.closest(".sub");if(t){const e=Number(t.dataset.id),{onClick:n}=x.find((t=>t.id===e))||{};n&&n.call(this)}else switch(e.target.className){case"view_button":(function(e){switch(e.id){case"full":this.parentElement.classList.toggle("fullscreen");break;case"mini":case"close":h.back()}}).call(this,e.target);break;case"edit_button":(function(e){e.querySelector(".popup").classList.toggle("show"),this.querySelectorAll(".popup").forEach((t=>{t!==e.querySelector(".popup")&&t.classList.remove("show")}))}).call(this,e.target)}}}(async()=>{await t.openDB(),customElements.define("my-app",s),customElements.define("my-footer",u),customElements.define("my-home",y),customElements.define("my-tetris",m),customElements.define("my-flappybird",k),customElements.define("my-icons",v),customElements.define("my-icon",g),customElements.define("my-notepad",f),customElements.define("my-notepad-header",C)})(),window.addEventListener("popstate",(()=>h.render()))})();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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cmNlcyI6WyJ3ZWJwYWNrOi8vamF2YXNjcmlwdC1zYW5kYm94L3dlYnBhY2svYm9vdHN0cmFwIiwid2VicGFjazovL2phdmFzY3JpcHQtc2FuZGJveC93ZWJwYWNrL3J1bnRpbWUvcHVibGljUGF0aCIsIndlYnBhY2s6Ly9qYXZhc2NyaXB0LXNhbmRib3gvLi9zcmMvY29yZS9JbmRleGVkREIuanMiLCJ3ZWJwYWNrOi8vamF2YXNjcmlwdC1zYW5kYm94Ly4vc3JjL3V0aWxzL3V0aWxzLmpzIiwid2VicGFjazovL2phdmFzY3JpcHQtc2FuZGJveC8uL3NyYy9jb3JlL1dlYkNvbXBvbmVudC5qcyIsIndlYnBhY2s6Ly9qYXZhc2NyaXB0LXNhbmRib3gvLi9zcmMvQXBwLmpzIiwid2VicGFjazovL2phdmFzY3JpcHQtc2FuZGJveC8uL3NyYy91dGlscy9yb3V0ZXMuanMiLCJ3ZWJwYWNrOi8vamF2YXNjcmlwdC1zYW5kYm94Ly4vc3JjL2NvcmUvUm91dGVyLmpzIiwid2VicGFjazovL2phdmFzY3JpcHQtc2FuZGJveC8uL3NyYy92aWV3L0NvbW1vbi9Gb290ZXIuanMiLCJ3ZWJwYWNrOi8vamF2YXNjcmlwdC1zYW5kYm94Ly4vc3JjL3ZpZXcvSG9tZS9pbmRleC5qcyIsIndlYnBhY2s6Ly9qYXZhc2NyaXB0LXNhbmRib3gvLi9zcmMvdmlldy9UZXRyaXMvaW5kZXguanMiLCJ3ZWJwYWNrOi8vamF2YXNjcmlwdC1zYW5kYm94Ly4vc3JjL3ZpZXcvRmxhcHB5QmlyZC9pbmRleC5qcyIsIndlYnBhY2s6Ly9qYXZhc2NyaXB0LXNhbmRib3gvLi9zcmMvdmlldy9Db21tb24vSWNvbnMuanMiLCJ3ZWJwYWNrOi8vamF2YXNjcmlwdC1zYW5kYm94Ly4vc3JjL3ZpZXcvQ29tbW9uL0ljb24uanMiLCJ3ZWJwYWNrOi8vamF2YXNjcmlwdC1zYW5kYm94Ly4vc3JjL3ZpZXcvTm90ZVBhZC9pbmRleC5qcyIsIndlYnBhY2s6Ly9qYXZhc2NyaXB0LXNhbmRib3gvLi9zcmMvdmlldy9Ob3RlUGFkL2NvbnN0L2J1dHRvbnMuanMiLCJ3ZWJwYWNrOi8vamF2YXNjcmlwdC1zYW5kYm94Ly4vc3JjL3ZpZXcvTm90ZVBhZC9jb21wb25lbnRzL05vdGVQYWRIZWFkZXIuanMiLCJ3ZWJwYWNrOi8vamF2YXNjcmlwdC1zYW5kYm94Ly4vc3JjL2luZGV4LmpzIl0sInNvdXJjZXNDb250ZW50IjpbIi8vIFRoZSByZXF1aXJlIHNjb3BlXG52YXIgX193ZWJwYWNrX3JlcXVpcmVfXyA9IHt9O1xuXG4iLCJfX3dlYnBhY2tfcmVxdWlyZV9fLnAgPSBcIi9qcy1zYW5kYm94L1wiOyIsImNsYXNzIEluZGV4ZWREQiB7XHJcbiAgZGI7XHJcblxyXG4gIC8qKlxyXG4gICAqIOyDneyEseyekFxyXG4gICAqIEBwYXJhbSB7c3RyaW5nfSBkYk5hbWVcclxuICAgKiBAcGFyYW0ge251bWJlcn0gZGJWZXJzaW9uXHJcbiAgICogQHBhcmFtIHtzdHJpbmdbXX0gc3RvcmVzXHJcbiAgICovXHJcbiAgY29uc3RydWN0b3IoZGJOYW1lLCBkYlZlcnNpb24sIHN0b3Jlcykge1xyXG4gICAgdGhpcy5kYk5hbWUgPSBkYk5hbWU7XHJcbiAgICB0aGlzLmRiVmVyc2lvbiA9IGRiVmVyc2lvbjtcclxuICAgIHRoaXMuc3RvcmVzID0gc3RvcmVzO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogREIg7Jik7ZSIIOuplOyEnOuTnFxyXG4gICAqIEByZXR1cm5zIHtQcm9taXNlPHZvaWQ+fVxyXG4gICAqL1xyXG4gIGFzeW5jIG9wZW5EQigpIHtcclxuICAgIHJldHVybiBuZXcgUHJvbWlzZSgocmVzb2x2ZSwgcmVqZWN0KSA9PiB7XHJcbiAgICAgIGNvbnN0IHJlcXVlc3QgPSB3aW5kb3cuaW5kZXhlZERCLm9wZW4odGhpcy5kYk5hbWUsIHRoaXMuZGJWZXJzaW9uKTtcclxuXHJcbiAgICAgIHJlcXVlc3Qub25zdWNjZXNzID0gKCkgPT4ge1xyXG4gICAgICAgIHRoaXMuZGIgPSByZXF1ZXN0LnJlc3VsdDtcclxuICAgICAgICByZXNvbHZlKCk7XHJcbiAgICAgIH07XHJcblxyXG4gICAgICByZXF1ZXN0Lm9uZXJyb3IgPSAoZSkgPT4ge1xyXG4gICAgICAgIHJlamVjdChlKTtcclxuICAgICAgfTtcclxuXHJcbiAgICAgIHJlcXVlc3Qub251cGdyYWRlbmVlZGVkID0gKCkgPT4ge1xyXG4gICAgICAgIHRoaXMuZGIgPSByZXF1ZXN0LnJlc3VsdDtcclxuXHJcbiAgICAgICAgdGhpcy5zdG9yZXMuZm9yRWFjaCgoc3RvcmUpID0+IHtcclxuICAgICAgICAgIGlmICh0aGlzLmRiLm9iamVjdFN0b3JlTmFtZXMuY29udGFpbnMoc3RvcmUpKSB7XHJcbiAgICAgICAgICAgIHRoaXMuZGIuZGVsZXRlT2JqZWN0U3RvcmUoc3RvcmUpO1xyXG4gICAgICAgICAgfVxyXG4gICAgICAgICAgdGhpcy5kYi5jcmVhdGVPYmplY3RTdG9yZShzdG9yZSwgeyBrZXlQYXRoOiAnaWQnLCBhdXRvSW5jcmVtZW50OiB0cnVlIH0pO1xyXG4gICAgICAgIH0pO1xyXG4gICAgICB9O1xyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiDrjbDsnbTthLAg7KGw7ZqMIOuplOyEnOuTnFxyXG4gICAqIEBwYXJhbSB7c3RyaW5nfSBzdG9yZU5hbWVcclxuICAgKiBAcGFyYW0ge251bWJlcn0gaWRcclxuICAgKiBAcmV0dXJucyB7UHJvbWlzZTxvYmplY3Q+fVxyXG4gICAqL1xyXG4gIGFzeW5jIGdldERhdGEoc3RvcmVOYW1lLCBpZCkge1xyXG4gICAgcmV0dXJuIG5ldyBQcm9taXNlKChyZXNvbHZlLCByZWplY3QpID0+IHtcclxuICAgICAgY29uc3QgcmVxdWVzdCA9IHRoaXMuZGIudHJhbnNhY3Rpb24oc3RvcmVOYW1lLCAncmVhZG9ubHknKS5vYmplY3RTdG9yZShzdG9yZU5hbWUpLmdldChpZCk7XHJcblxyXG4gICAgICByZXF1ZXN0Lm9uc3VjY2VzcyA9ICgpID0+IHtcclxuICAgICAgICByZXNvbHZlKHJlcXVlc3QucmVzdWx0KTtcclxuICAgICAgfTtcclxuXHJcbiAgICAgIHJlcXVlc3Qub25lcnJvciA9IChlKSA9PiB7XHJcbiAgICAgICAgcmVqZWN0KGUpO1xyXG4gICAgICB9O1xyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiDrjbDsnbTthLAg7KCE7LK0IOyhsO2ajCDrqZTshJzrk5xcclxuICAgKiBAcGFyYW0ge3N0cmluZ30gc3RvcmVOYW1lXHJcbiAgICogQHJldHVybnMge1Byb21pc2U8b2JqZWN0W10+fVxyXG4gICAqL1xyXG4gIGFzeW5jIGdldEFsbERhdGEoc3RvcmVOYW1lKSB7XHJcbiAgICByZXR1cm4gbmV3IFByb21pc2UoKHJlc29sdmUsIHJlamVjdCkgPT4ge1xyXG4gICAgICBjb25zdCByZXF1ZXN0ID0gdGhpcy5kYi50cmFuc2FjdGlvbihzdG9yZU5hbWUsICdyZWFkb25seScpLm9iamVjdFN0b3JlKHN0b3JlTmFtZSkuZ2V0QWxsKCk7XHJcblxyXG4gICAgICByZXF1ZXN0Lm9uc3VjY2VzcyA9ICgpID0+IHtcclxuICAgICAgICByZXNvbHZlKHJlcXVlc3QucmVzdWx0KTtcclxuICAgICAgfTtcclxuXHJcbiAgICAgIHJlcXVlc3Qub25lcnJvciA9IChlKSA9PiB7XHJcbiAgICAgICAgcmVqZWN0KGUpO1xyXG4gICAgICB9O1xyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiDrjbDsnbTthLAg7LaU6rCAIOuplOyEnOuTnFxyXG4gICAqIEBwYXJhbSB7c3RyaW5nfSBzdG9yZU5hbWVcclxuICAgKiBAcGFyYW0ge29iamVjdH0gZGF0YVxyXG4gICAqIEByZXR1cm5zIHtQcm9taXNlPG9iamVjdD59XHJcbiAgICovXHJcbiAgYXN5bmMgdXBzZXJ0RGF0YShzdG9yZU5hbWUsIGRhdGEpIHtcclxuICAgIHJldHVybiBuZXcgUHJvbWlzZSgocmVzb2x2ZSwgcmVqZWN0KSA9PiB7XHJcbiAgICAgIGNvbnN0IHJlcXVlc3QgPSB0aGlzLmRiLnRyYW5zYWN0aW9uKHN0b3JlTmFtZSwgJ3JlYWR3cml0ZScpLm9iamVjdFN0b3JlKHN0b3JlTmFtZSkucHV0KGRhdGEpO1xyXG5cclxuICAgICAgcmVxdWVzdC5vbnN1Y2Nlc3MgPSAoKSA9PiB7XHJcbiAgICAgICAgcmVzb2x2ZShyZXF1ZXN0LnJlc3VsdCk7XHJcbiAgICAgIH07XHJcblxyXG4gICAgICByZXF1ZXN0Lm9uZXJyb3IgPSAoZSkgPT4ge1xyXG4gICAgICAgIHJlamVjdChlKTtcclxuICAgICAgfTtcclxuICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICog642w7J207YSwIOyCreygnCDrqZTshJzrk5xcclxuICAgKiBAcGFyYW0ge3N0cmluZ30gc3RvcmVOYW1lXHJcbiAgICogQHBhcmFtIHtudW1iZXJ9IGlkXHJcbiAgICogQHJldHVybnMge1Byb21pc2U8b2JqZWN0Pn1cclxuICAgKi9cclxuICBhc3luYyBkZWxldGVEYXRhKHN0b3JlTmFtZSwgaWQpIHtcclxuICAgIHJldHVybiBuZXcgUHJvbWlzZSgocmVzb2x2ZSwgcmVqZWN0KSA9PiB7XHJcbiAgICAgIGNvbnN0IHJlcXVlc3QgPSB0aGlzLmRiLnRyYW5zYWN0aW9uKHN0b3JlTmFtZSwgJ3JlYWR3cml0ZScpLm9iamVjdFN0b3JlKHN0b3JlTmFtZSkuZGVsZXRlKGlkKTtcclxuXHJcbiAgICAgIHJlcXVlc3Qub25zdWNjZXNzID0gKCkgPT4ge1xyXG4gICAgICAgIHJlc29sdmUocmVxdWVzdC5yZXN1bHQpO1xyXG4gICAgICB9O1xyXG5cclxuICAgICAgcmVxdWVzdC5vbmVycm9yID0gKGUpID0+IHtcclxuICAgICAgICByZWplY3QoZSk7XHJcbiAgICAgIH07XHJcbiAgICB9KTtcclxuICB9XHJcbn1cclxuXHJcbmNvbnN0IHNhbmRib3hEQiA9IG5ldyBJbmRleGVkREIoJ3NhbmRib3hEQicsIDIsIFsnbm90ZXBhZCddKTtcclxuXHJcbmV4cG9ydCBkZWZhdWx0IHNhbmRib3hEQjtcclxuIiwiY29uc3QgcmVuZGVyUmF3ID0gKHN0cmluZywgLi4udmFsdWVzKSA9PiB7XHJcbiAgcmV0dXJuIFN0cmluZy5yYXcoc3RyaW5nLCAuLi52YWx1ZXMpO1xyXG59O1xyXG5cclxuZXhwb3J0IHsgcmVuZGVyUmF3IGFzIGh0bWwsIHJlbmRlclJhdyBhcyBjc3MgfTtcclxuIiwiZXhwb3J0IGRlZmF1bHQgY2xhc3MgV2ViQ29tcG9uZW50IGV4dGVuZHMgSFRNTEVsZW1lbnQge1xyXG4gIGNvbm5lY3RlZENhbGxiYWNrKCkge1xyXG4gICAgdGhpcy5yZW5kZXIoKTtcclxuICB9XHJcblxyXG4gIHJlbmRlcigpIHtcclxuICAgIHRoaXMuaW5uZXJIVE1MID0gdGhpcy5pbmplY3RIVE1MKCk7XHJcbiAgfVxyXG5cclxuICBpbmplY3RIVE1MKCkge1xyXG4gICAgcmV0dXJuIGBgO1xyXG4gIH1cclxufVxyXG4iLCJpbXBvcnQgeyBodG1sIH0gZnJvbSAnLi91dGlscy91dGlscyc7XHJcbmltcG9ydCBXZWJDb21wb25lbnQgZnJvbSAnLi9jb3JlL1dlYkNvbXBvbmVudCc7XHJcblxyXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBBcHAgZXh0ZW5kcyBXZWJDb21wb25lbnQge1xyXG4gIGluamVjdEhUTUwoKSB7XHJcbiAgICByZXR1cm4gaHRtbGBcclxuICAgICAgPGRpdiBpZD1cInBhZ2VcIj48L2Rpdj5cclxuICAgICAgPG15LWljb25zIHRhYmluZGV4PVwiLTFcIj48L215LWljb25zPlxyXG4gICAgICA8bXktZm9vdGVyPjwvbXktZm9vdGVyPlxyXG4gICAgYDtcclxuICB9XHJcbn1cclxuIiwiaW1wb3J0IHsgaHRtbCB9IGZyb20gJy4vdXRpbHMnO1xyXG5pbXBvcnQgdGV0cmlzIGZyb20gJy4uLy4uL3B1YmxpYy90ZXRyaXMucG5nJztcclxuaW1wb3J0IGZsYXBweUJpcmQgZnJvbSAnLi4vLi4vcHVibGljL2ZsYXBweUJpcmQucG5nJztcclxuaW1wb3J0IG5vdGVwYWQgZnJvbSAnLi4vLi4vcHVibGljL25vdGVwYWQucG5nJztcclxuaW1wb3J0IHNhbmRib3hEQiBmcm9tICcuLi9jb3JlL0luZGV4ZWREQic7XHJcblxyXG5jb25zdCByb3V0ZXMgPSBbXHJcbiAge1xyXG4gICAgcGF0aDogJy8nLFxyXG4gICAgaHRtbDogaHRtbGA8bXktaG9tZT48L215LWhvbWU+YCxcclxuICAgIGxhYmVsOiAnSG9tZScsXHJcbiAgICBpY29uU3JjOiBudWxsLFxyXG4gIH0sXHJcbiAge1xyXG4gICAgcGF0aDogJy90ZXRyaXMnLFxyXG4gICAgaHRtbDogaHRtbGA8bXktdGV0cmlzPjwvbXktdGV0cmlzPmAsXHJcbiAgICBsYWJlbDogJ1RldHJpcycsXHJcbiAgICBpY29uU3JjOiB0ZXRyaXMsXHJcbiAgfSxcclxuICB7XHJcbiAgICBwYXRoOiAnL2ZsYXBweWJpcmQnLFxyXG4gICAgaHRtbDogaHRtbGA8bXktZmxhcHB5YmlyZD48L215LWZsYXBweWJpcmQ+YCxcclxuICAgIGxhYmVsOiAnRmxhcHB5Jm5ic3A7QmlyZCcsXHJcbiAgICBpY29uU3JjOiBmbGFwcHlCaXJkLFxyXG4gIH0sXHJcbiAge1xyXG4gICAgcGF0aDogJy9ub3RlcGFkJyxcclxuICAgIGh0bWw6IGh0bWxgPG15LW5vdGVwYWQ+PC9teS1ub3RlcGFkPmAsXHJcbiAgICBsYWJlbDogJ05vdGUmbmJzcDtQYWQnLFxyXG4gICAgaWNvblNyYzogbm90ZXBhZCxcclxuICB9LFxyXG5dO1xyXG5cclxuY29uc3QgbWFpbkljb25zID0gcm91dGVzLnJlZHVjZSgocHJldiwgcm91dGVyKSA9PiB7XHJcbiAgY29uc3QgeyBwYXRoLCBsYWJlbCwgaWNvblNyYyB9ID0gcm91dGVyO1xyXG4gIGlmIChyb3V0ZXIucGF0aCA9PT0gJy8nKSByZXR1cm4gcHJldjtcclxuICByZXR1cm4gWy4uLnByZXYsIHsgcGF0aCwgbGFiZWwsIGljb25TcmMgfV07XHJcbn0sIFtdKTtcclxuXHJcbmNvbnN0IGdldExvY2FsSWNvbnMgPSBhc3luYyAoKSA9PiB7XHJcbiAgY29uc3Qgbm90ZXBhZERhdGEgPSBhd2FpdCBzYW5kYm94REIuZ2V0QWxsRGF0YSgnbm90ZXBhZCcpO1xyXG4gIGNvbnN0IG5vdGVwYWRJY29ucyA9IG5vdGVwYWREYXRhLnJlZHVjZSgocHJldiwgaWNvbikgPT4ge1xyXG4gICAgY29uc3QgeyBpZCwgdGl0bGUgfSA9IGljb247XHJcbiAgICByZXR1cm4gWy4uLnByZXYsIHsgcGF0aDogYC9ub3RlcGFkLyR7aWR9YCwgbGFiZWw6IHRpdGxlLCBpY29uU3JjOiBub3RlcGFkIH1dO1xyXG4gIH0sIFtdKTtcclxuXHJcbiAgcmV0dXJuIFsuLi5ub3RlcGFkSWNvbnNdO1xyXG59O1xyXG5cclxuZXhwb3J0IGRlZmF1bHQgcm91dGVzO1xyXG5leHBvcnQgeyBtYWluSWNvbnMsIGdldExvY2FsSWNvbnMgfTtcclxuIiwiaW1wb3J0IHJvdXRlcyBmcm9tICcuLi91dGlscy9yb3V0ZXMnO1xuXG5jb25zdCBCQVNFX1VSTCA9IHByb2Nlc3MuZW52Lk5PREVfRU5WID09PSAnZGV2ZWxvcG1lbnQnID8gJycgOiAnL2pzLXNhbmRib3gnO1xuXG5jbGFzcyBSb3V0ZXIge1xuICBjb25zdHJ1Y3Rvcihyb3V0ZSkge1xuICAgIHRoaXMucm91dGVzID0gcm91dGU7XG4gIH1cblxuICByZW5kZXIoKSB7XG4gICAgY29uc3Qgcm91dGUgPSB0aGlzLnJvdXRlcy5maW5kKCh2YWx1ZSkgPT4gdmFsdWUucGF0aCA9PT0gd2luZG93LmxvY2F0aW9uLnBhdGhuYW1lLnJlcGxhY2UoQkFTRV9VUkwsICcnKSk7XG5cbiAgICBpZiAoIXJvdXRlKSB7XG4gICAgICB0aGlzLnJlcGxhY2VUbygnLycpO1xuICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJyNwYWdlJykuaW5uZXJIVE1MID0gcm91dGUuaHRtbDtcbiAgfVxuXG4gIG5hdmlnYXRlVG8odXJsKSB7XG4gICAgd2luZG93Lmhpc3RvcnkucHVzaFN0YXRlKG51bGwsIG51bGwsIEJBU0VfVVJMICsgdXJsKTtcbiAgICB0aGlzLnJlbmRlcigpO1xuICB9XG5cbiAgcmVwbGFjZVRvKHVybCkge1xuICAgIHdpbmRvdy5oaXN0b3J5LnJlcGxhY2VTdGF0ZShudWxsLCBudWxsLCBCQVNFX1VSTCArIHVybCk7XG4gICAgdGhpcy5yZW5kZXIoKTtcbiAgfVxuXG4gIGJhY2soKSB7XG4gICAgd2luZG93Lmhpc3RvcnkuYmFjaygpO1xuICAgIHRoaXMucmVuZGVyKCk7XG4gIH1cbn1cblxuY29uc3Qgcm91dGVyID0gbmV3IFJvdXRlcihyb3V0ZXMpO1xuXG5leHBvcnQgZGVmYXVsdCByb3V0ZXI7XG4iLCJpbXBvcnQgV2ViQ29tcG9uZW50IGZyb20gJy4uLy4uL2NvcmUvV2ViQ29tcG9uZW50JztcclxuaW1wb3J0IHsgaHRtbCB9IGZyb20gJy4uLy4uL3V0aWxzL3V0aWxzJztcclxuaW1wb3J0IHsgbWFpbkljb25zIH0gZnJvbSAnLi4vLi4vdXRpbHMvcm91dGVzJztcclxuaW1wb3J0IHJvdXRlciBmcm9tICcuLi8uLi9jb3JlL1JvdXRlcic7XHJcbmltcG9ydCB3aW5kb3dMb2dvIGZyb20gJy4uLy4uLy4uL3B1YmxpYy93aW5kb3dMb2dvLnBuZyc7XHJcbmltcG9ydCBzZWFyY2hJY29uIGZyb20gJy4uLy4uLy4uL3B1YmxpYy9zZWFyY2hJY29uLnBuZyc7XHJcblxyXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBGb290ZXIgZXh0ZW5kcyBXZWJDb21wb25lbnQge1xyXG4gIGNvbm5lY3RlZENhbGxiYWNrKCkge1xyXG4gICAgc3VwZXIuY29ubmVjdGVkQ2FsbGJhY2soKTtcclxuICAgIHRoaXMuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCB0aGlzLmhhbmRsZUNsaWNrLmJpbmQodGhpcykpO1xyXG4gIH1cclxuXHJcbiAgaW5qZWN0SFRNTCgpIHtcclxuICAgIHJldHVybiBodG1sYFxyXG4gICAgICA8aW1nIGFsdD1cIndpbmRvd19sb2dvXCIgc3JjPSR7d2luZG93TG9nb30gY2xhc3M9XCJ3aW5kb3dfaWNvblwiIC8+XHJcbiAgICAgIDxkaXYgY2xhc3M9XCJpbnB1dF9ib3hcIj5cclxuICAgICAgICA8aW1nIGFsdD1cInNlYXJjaFwiIHNyYz0ke3NlYXJjaEljb259IGNsYXNzPVwid2luZG93X2ljb25cIiAvPjxpbnB1dCB0eXBlPVwidGV4dFwiIHBsYWNlaG9sZGVyPVwi7LC+6riwXCIgLz5cclxuICAgICAgPC9kaXY+XHJcbiAgICAgICR7bWFpbkljb25zXHJcbiAgICAgICAgLm1hcCgoaWNvbikgPT4ge1xyXG4gICAgICAgICAgcmV0dXJuIGh0bWxgIDxteS1pY29uIGRhdGEtcGF0aD1cIiR7aWNvbi5wYXRofVwiIGRhdGEtaWNvblNyYz1cIiR7aWNvbi5pY29uU3JjfVwiPjwvbXktaWNvbj4gYDtcclxuICAgICAgICB9KVxyXG4gICAgICAgIC5qb2luKCcnKX1cclxuICAgIGA7XHJcbiAgfVxyXG5cclxuICBoYW5kbGVDbGljayhlKSB7XHJcbiAgICBpZiAoIWUudGFyZ2V0LmNsb3Nlc3QoJ215LWljb24nKSkgcmV0dXJuO1xyXG5cclxuICAgIGNvbnN0IGljb24gPSBlLnRhcmdldC5jbG9zZXN0KCdteS1pY29uJyk7XHJcbiAgICByb3V0ZXIubmF2aWdhdGVUbyhpY29uLmRhdGFzZXQucGF0aCk7XHJcbiAgfVxyXG59XHJcbiIsImltcG9ydCBXZWJDb21wb25lbnQgZnJvbSAnLi4vLi4vY29yZS9XZWJDb21wb25lbnQnO1xyXG5cclxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgSG9tZSBleHRlbmRzIFdlYkNvbXBvbmVudCB7fVxyXG4iLCJpbXBvcnQgV2ViQ29tcG9uZW50IGZyb20gJy4uLy4uL2NvcmUvV2ViQ29tcG9uZW50JztcclxuaW1wb3J0IHsgaHRtbCB9IGZyb20gJy4uLy4uL3V0aWxzL3V0aWxzJztcclxuXHJcbmV4cG9ydCBkZWZhdWx0IGNsYXNzIFRldHJpcyBleHRlbmRzIFdlYkNvbXBvbmVudCB7XHJcbiAgaW5qZWN0SFRNTCgpIHtcclxuICAgIHJldHVybiBodG1sYFxyXG4gICAgICA8aDE+VGV0cmlzPC9oMT5cclxuICAgICAgPHA+WW91IGFyZSB2aWV3aW5nIHRoZSBUZXRyaXMgY29tcG9uZW50ITwvcD5cclxuICAgIGA7XHJcbiAgfVxyXG59XHJcbiIsImltcG9ydCBXZWJDb21wb25lbnQgZnJvbSAnLi4vLi4vY29yZS9XZWJDb21wb25lbnQnO1xyXG5pbXBvcnQgeyBodG1sIH0gZnJvbSAnLi4vLi4vdXRpbHMvdXRpbHMnO1xyXG5cclxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgRmxhcHB5QmlyZCBleHRlbmRzIFdlYkNvbXBvbmVudCB7XHJcbiAgaW5qZWN0SFRNTCgpIHtcclxuICAgIHJldHVybiBodG1sYFxyXG4gICAgICA8aDE+RmxhcHB5IEJpcmQ8L2gxPlxyXG4gICAgICA8cD5Zb3UgYXJlIHZpZXdpbmcgdGhlIEZsYXBweSBCaXJkIGNvbXBvbmVudCE8L3A+XHJcbiAgICAgIDxwPllvdSBhcmUgdmlld2luZyB0aGUgRmxhcHB5IEJpcmQgY29tcG9uZW50ITwvcD5cclxuICAgICAgPHA+WW91IGFyZSB2aWV3aW5nIHRoZSBGbGFwcHkgQmlyZCBjb21wb25lbnQhPC9wPlxyXG4gICAgICA8cD5Zb3UgYXJlIHZpZXdpbmcgdGhlIEZsYXBweSBCaXJkIGNvbXBvbmVudCE8L3A+XHJcbiAgICAgIDxwPllvdSBhcmUgdmlld2luZyB0aGUgRmxhcHB5IEJpcmQgY29tcG9uZW50ITwvcD5cclxuICAgICAgPHA+WW91IGFyZSB2aWV3aW5nIHRoZSBGbGFwcHkgQmlyZCBjb21wb25lbnQhPC9wPlxyXG4gICAgYDtcclxuICB9XHJcbn1cclxuIiwiaW1wb3J0IHsgaHRtbCB9IGZyb20gJy4uLy4uL3V0aWxzL3V0aWxzJztcclxuaW1wb3J0IHJvdXRlciBmcm9tICcuLi8uLi9jb3JlL1JvdXRlcic7XHJcbmltcG9ydCBXZWJDb21wb25lbnQgZnJvbSAnLi4vLi4vY29yZS9XZWJDb21wb25lbnQnO1xyXG5pbXBvcnQgeyBnZXRMb2NhbEljb25zLCBtYWluSWNvbnMgfSBmcm9tICcuLi8uLi91dGlscy9yb3V0ZXMnO1xyXG5cclxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgSWNvbnMgZXh0ZW5kcyBXZWJDb21wb25lbnQge1xyXG4gIGFzeW5jIGNvbm5lY3RlZENhbGxiYWNrKCkge1xyXG4gICAgdGhpcy5pY29ucyA9IFsuLi5tYWluSWNvbnMsIC4uLihhd2FpdCBnZXRMb2NhbEljb25zKCkpXTtcclxuICAgIHN1cGVyLmNvbm5lY3RlZENhbGxiYWNrKCk7XHJcbiAgICB0aGlzLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgdGhpcy5oYW5kbGVDbGljay5iaW5kKHRoaXMpKTtcclxuICAgIHRoaXMuYWRkRXZlbnRMaXN0ZW5lcignZGJsY2xpY2snLCB0aGlzLmhhbmRsZURvdWJsZUNsaWNrLmJpbmQodGhpcykpO1xyXG4gICAgdGhpcy5hZGRFdmVudExpc3RlbmVyKCdrZXlkb3duJywgdGhpcy5oYW5kbGVLZXlEb3duLmJpbmQodGhpcykpO1xyXG4gICAgdGhpcy5hZGRFdmVudExpc3RlbmVyKCdpY29uQ2hhbmdlJywgKGUpID0+IHtcclxuICAgICAgdGhpcy5pY29ucyA9IFsuLi50aGlzLmljb25zLCBlLmRldGFpbF07XHJcbiAgICB9KTtcclxuICB9XHJcblxyXG4gIHN0YXRpYyBnZXQgb2JzZXJ2ZWRBdHRyaWJ1dGVzKCkge1xyXG4gICAgcmV0dXJuIFsnaWNvbnMnXTtcclxuICB9XHJcblxyXG4gIGF0dHJpYnV0ZUNoYW5nZWRDYWxsYmFjayhuYW1lLCBvbGRWYWx1ZSwgbmV3VmFsdWUpIHtcclxuICAgIGlmIChvbGRWYWx1ZSA9PT0gbmV3VmFsdWUpIHJldHVybjtcclxuICAgIHRoaXMucmVuZGVyKCk7XHJcbiAgfVxyXG5cclxuICBpbmplY3RIVE1MKCkge1xyXG4gICAgcmV0dXJuIGh0bWxgXHJcbiAgICAgICR7dGhpcy5pY29uc1xyXG4gICAgICAgIC5tYXAoKGljb24pID0+IHtcclxuICAgICAgICAgIHJldHVybiBodG1sYFxyXG4gICAgICAgICAgICA8bXktaWNvbiBkYXRhLXBhdGg9JHtpY29uLnBhdGh9IGRhdGEtbGFiZWw9JHtpY29uLmxhYmVsfSBkYXRhLWljb25TcmM9JHtpY29uLmljb25TcmN9PjwvbXktaWNvbj5cclxuICAgICAgICAgIGA7XHJcbiAgICAgICAgfSlcclxuICAgICAgICAuam9pbignJyl9XHJcbiAgICBgO1xyXG4gIH1cclxuXHJcbiAgZ2V0IGljb25zKCkge1xyXG4gICAgcmV0dXJuIEpTT04ucGFyc2UodGhpcy5nZXRBdHRyaWJ1dGUoJ2ljb25zJykpO1xyXG4gIH1cclxuXHJcbiAgc2V0IGljb25zKHZhbHVlKSB7XHJcbiAgICB0aGlzLnNldEF0dHJpYnV0ZSgnaWNvbnMnLCBKU09OLnN0cmluZ2lmeSh2YWx1ZSkpO1xyXG4gIH1cclxuXHJcbiAgaGFuZGxlQ2xpY2soZSkge1xyXG4gICAgaWYgKCFlLnRhcmdldC5jbG9zZXN0KCdteS1pY29uJykpIHJldHVybjtcclxuXHJcbiAgICBjb25zdCBpY29uID0gZS50YXJnZXQuY2xvc2VzdCgnbXktaWNvbicpO1xyXG4gICAgaWNvbi50b2dnbGVBdHRyaWJ1dGUoJ2NoZWNrZWQnKTtcclxuICAgIHRoaXMucXVlcnlTZWxlY3RvckFsbCgnbXktaWNvbicpLmZvckVhY2goKG5vZGUpID0+IHtcclxuICAgICAgaWYgKG5vZGUgIT09IGljb24pIHtcclxuICAgICAgICBub2RlLnJlbW92ZUF0dHJpYnV0ZSgnY2hlY2tlZCcpO1xyXG4gICAgICB9XHJcbiAgICB9KTtcclxuICB9XHJcblxyXG4gIGhhbmRsZURvdWJsZUNsaWNrKGUpIHtcclxuICAgIGlmICghZS50YXJnZXQuY2xvc2VzdCgnbXktaWNvbicpKSByZXR1cm47XHJcblxyXG4gICAgY29uc3QgaWNvbiA9IGUudGFyZ2V0LmNsb3Nlc3QoJ215LWljb24nKTtcclxuICAgIHJvdXRlci5uYXZpZ2F0ZVRvKGljb24uZGF0YXNldC5wYXRoKTtcclxuICB9XHJcblxyXG4gIGhhbmRsZUtleURvd24oZSkge1xyXG4gICAgY29uc3QgY2hlY2tlZEVsID0gdGhpcy5xdWVyeVNlbGVjdG9yQWxsKCdteS1pY29uW2NoZWNrZWRdJyk7XHJcbiAgICBpZiAoZS5rZXkgPT09ICdFbnRlcicpIHtcclxuICAgICAgaWYgKGNoZWNrZWRFbC5sZW5ndGggPiAxKSByZXR1cm47XHJcbiAgICAgIGlmICghY2hlY2tlZEVsKSByZXR1cm47XHJcbiAgICAgIHJvdXRlci5uYXZpZ2F0ZVRvKGNoZWNrZWRFbFswXS5kYXRhc2V0LnBhdGgpO1xyXG4gICAgfVxyXG4gIH1cclxufVxyXG4iLCJpbXBvcnQgeyBodG1sIH0gZnJvbSAnLi4vLi4vdXRpbHMvdXRpbHMnO1xyXG5pbXBvcnQgV2ViQ29tcG9uZW50IGZyb20gJy4uLy4uL2NvcmUvV2ViQ29tcG9uZW50JztcclxuXHJcbmV4cG9ydCBkZWZhdWx0IGNsYXNzIEljb24gZXh0ZW5kcyBXZWJDb21wb25lbnQge1xyXG4gIGluamVjdEhUTUwoKSB7XHJcbiAgICBjb25zdCB7IGxhYmVsLCBpY29uc3JjIH0gPSB0aGlzLmRhdGFzZXQ7XHJcbiAgICByZXR1cm4gaHRtbGBcclxuICAgICAgPGltZyBhbHQ9XCIke2xhYmVsfV9pY29uXCIgc3JjPSR7aWNvbnNyY30gLz5cclxuICAgICAgJHtsYWJlbCA/IGA8c3BhbiBjbGFzcz1cImljb25fbmFtZVwiPiR7bGFiZWx9PC9zcGFuPmAgOiAnJ31cclxuICAgIGA7XHJcbiAgfVxyXG59XHJcbiIsImltcG9ydCBXZWJDb21wb25lbnQgZnJvbSAnLi4vLi4vY29yZS9XZWJDb21wb25lbnQnO1xuaW1wb3J0IHsgaHRtbCB9IGZyb20gJy4uLy4uL3V0aWxzL3V0aWxzJztcbmltcG9ydCAnLi9zdHlsZXMuc2Nzcyc7XG5pbXBvcnQgc2FuZGJveERCIGZyb20gJy4uLy4uL2NvcmUvSW5kZXhlZERCJztcbmltcG9ydCBOb3RlUGFkSWNvbiBmcm9tICcuLi8uLi8uLi9wdWJsaWMvbm90ZXBhZC5wbmcnO1xuXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBOb3RlUGFkIGV4dGVuZHMgV2ViQ29tcG9uZW50IHtcbiAgY29ubmVjdGVkQ2FsbGJhY2soKSB7XG4gICAgc3VwZXIuY29ubmVjdGVkQ2FsbGJhY2soKTtcbiAgICB0aGlzLmFkZEV2ZW50TGlzdGVuZXIoJ3NhdmUnLCB0aGlzLmhhbmRsZVNhdmUpO1xuICAgIHRoaXMuYWRkRXZlbnRMaXN0ZW5lcignbG9jYWxTYXZlJywgdGhpcy5oYW5kbGVMb2NhbFNhdmUpO1xuICB9XG5cbiAgZGlzY29ubmVjdGVkQ2FsbGJhY2soKSB7XG4gICAgdGhpcy5yZW1vdmVFdmVudExpc3RlbmVyKCdzYXZlJywgdGhpcy5oYW5kbGVTYXZlKTtcbiAgICB0aGlzLnJlbW92ZUV2ZW50TGlzdGVuZXIoJ2xvY2FsU2F2ZScsIHRoaXMuaGFuZGxlTG9jYWxTYXZlKTtcbiAgfVxuXG4gIGluamVjdEhUTUwoKSB7XG4gICAgcmV0dXJuIGh0bWxgXG4gICAgICA8bXktbm90ZXBhZC1oZWFkZXI+PC9teS1ub3RlcGFkLWhlYWRlcj5cbiAgICAgIDx0ZXh0YXJlYT48L3RleHRhcmVhPlxuICAgIGA7XG4gIH1cblxuICBoYW5kbGVMb2NhbFNhdmUoKSB7XG4gICAgY29uc3Qgbm90ZVBhZERhdGEgPSB0aGlzLmdldE5vdGVQYWREYXRhKCk7XG4gICAgaWYgKG5vdGVQYWREYXRhID09PSAnZmFpbCcpIHJldHVybjtcblxuICAgIHRyeSB7XG4gICAgICBjb25zdCBibG9iID0gbmV3IEJsb2IoW25vdGVQYWREYXRhLmNvbnRlbnRdLCB7IHR5cGU6ICd0ZXh0L3BsYWluJyB9KTtcbiAgICAgIGNvbnN0IGxpbmsgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdhJyk7XG4gICAgICBsaW5rLmhyZWYgPSBVUkwuY3JlYXRlT2JqZWN0VVJMKGJsb2IpO1xuICAgICAgbGluay5kb3dubG9hZCA9IGAke25vdGVQYWREYXRhLnRpdGxlfS50eHRgO1xuICAgICAgbGluay5jbGljaygpO1xuICAgIH0gY2F0Y2ggKGVycikge1xuICAgICAgYWxlcnQoJ+yggOyepeyXkCDsi6TtjKjtlojsirXri4jri6QuJyk7XG4gICAgICBjb25zb2xlLmVycm9yKGVycik7XG4gICAgfSBmaW5hbGx5IHtcbiAgICAgIHRoaXMucXVlcnlTZWxlY3RvcigndGV4dGFyZWEnKS52YWx1ZSA9ICcnO1xuICAgIH1cbiAgfVxuXG4gIGFzeW5jIGhhbmRsZVNhdmUoZSkge1xuICAgIGUuc3RvcFByb3BhZ2F0aW9uKCk7XG4gICAgY29uc3Qgbm90ZVBhZERhdGEgPSB0aGlzLmdldE5vdGVQYWREYXRhKCk7XG4gICAgaWYgKG5vdGVQYWREYXRhID09PSAnZmFpbCcpIHJldHVybjtcblxuICAgIHRyeSB7XG4gICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBzYW5kYm94REIudXBzZXJ0RGF0YSgnbm90ZXBhZCcsIHtcbiAgICAgICAgdGl0bGU6IG5vdGVQYWREYXRhLnRpdGxlLnJlcGxhY2UoLyAvZywgJyZuYnNwOycpLFxuICAgICAgICBjb250ZW50OiBub3RlUGFkRGF0YS5jb250ZW50XG4gICAgICAgICAgLnJlcGxhY2UoLyAvZywgJyZuYnNwOycpXG4gICAgICAgICAgLnJlcGxhY2UoL1xcbi9nLCAnPGJyPicpXG4gICAgICAgICAgLnJlcGxhY2UoL1xcdC9nLCAnJm5ic3A7Jm5ic3A7Jm5ic3A7Jm5ic3A7JyksXG4gICAgICB9KTtcbiAgICAgIGlmIChyZXN1bHQpIHtcbiAgICAgICAgYWxlcnQoJ+yggOyepeuQmOyXiOyKteuLiOuLpC4nKTtcbiAgICAgIH1cbiAgICAgIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJ215LWljb25zJykuZGlzcGF0Y2hFdmVudChcbiAgICAgICAgbmV3IEN1c3RvbUV2ZW50KCdpY29uQ2hhbmdlJywge1xuICAgICAgICAgIGRldGFpbDoge1xuICAgICAgICAgICAgcGF0aDogYC9ub3RlcGFkLyR7cmVzdWx0fWAsXG4gICAgICAgICAgICBsYWJlbDogbm90ZVBhZERhdGEudGl0bGUucmVwbGFjZSgvIC9nLCAnJm5ic3A7JyksXG4gICAgICAgICAgICBpY29uU3JjOiBOb3RlUGFkSWNvbixcbiAgICAgICAgICB9LFxuICAgICAgICB9KVxuICAgICAgKTtcbiAgICB9IGNhdGNoIChlcnIpIHtcbiAgICAgIGFsZXJ0KCfsoIDsnqXsl5Ag7Iuk7Yyo7ZaI7Iq164uI64ukLicpO1xuICAgICAgY29uc29sZS5lcnJvcihlcnIpO1xuICAgIH0gZmluYWxseSB7XG4gICAgICB0aGlzLnF1ZXJ5U2VsZWN0b3IoJ3RleHRhcmVhJykudmFsdWUgPSAnJztcbiAgICB9XG4gIH1cblxuICBnZXROb3RlUGFkRGF0YSgpIHtcbiAgICBjb25zdCBjb250ZW50ID0gdGhpcy5xdWVyeVNlbGVjdG9yKCd0ZXh0YXJlYScpLnZhbHVlO1xuICAgIGlmICghY29udGVudCkge1xuICAgICAgYWxlcnQoJ+uCtOyaqeydtCDsl4bsirXri4jri6QuJyk7XG4gICAgICByZXR1cm4gJ2ZhaWwnO1xuICAgIH1cbiAgICBsZXQgdGl0bGUgPSBwcm9tcHQoJ+yggOyepe2VoCDtjIzsnbzrqoXsnYQg7J6F66Cl7ZWY7IS47JqUJywgJ+ygnOuqqeyXhuydjCcpO1xuICAgIHdoaWxlICh0aXRsZSA9PT0gbnVsbCB8fCB0aXRsZSA9PT0gdW5kZWZpbmVkIHx8IHRpdGxlID09PSAnJykge1xuICAgICAgaWYgKHRpdGxlID09PSBudWxsKSByZXR1cm4gJ2ZhaWwnO1xuICAgICAgdGl0bGUgPSBwcm9tcHQoJ+2MjOydvOuqheydgCDtlYTsiJjsnoXri4jri6QuJywgJ+ygnOuqqeyXhuydjCcpO1xuICAgIH1cblxuICAgIHJldHVybiB7IHRpdGxlLCBjb250ZW50IH07XG4gIH1cbn1cbiIsImNvbnN0IGJ1dHRvbnMgPSBbXHJcbiAge1xyXG4gICAgaWQ6ICdmaWxlJyxcclxuICAgIHRpdGxlOiAn7YyM7J28JyxcclxuICAgIGtleTogJ0YnLFxyXG4gICAgc2xvdHM6IFtcclxuICAgICAgeyBpZDogMSwgdGV4dDogJ+yDiOuhnCDrp4zrk6TquLAoTiknLCBrZXk6IFsnQ3RybCcsICdOJ10sIGRpc2FibGU6IHRydWUgfSxcclxuICAgICAgeyBpZDogMiwgdGV4dDogJ+uCtCDsu7Ttk6jthLDsl5Ag7KCA7J6lKFcpJywga2V5OiBbJ0N0cmwnLCAnU2hpZnQnLCAnTiddLCBvbkNsaWNrOiBoYW5kbGVMb2NhbFNhdmVDbGljayB9LFxyXG4gICAgICB7IGlkOiAzLCB0ZXh0OiAn7KCA7J6lKFMpJywga2V5OiBbJ0N0cmwnLCAnUyddLCBvbkNsaWNrOiBoYW5kbGVTYXZlQ2xpY2sgfSxcclxuICAgICAgeyBpZDogNCwgdGV4dDogJ+yCreygnChEKScsIGtleTogWydDdHJsJywgJ1NoaWZ0JywgJ1MnXSwgZGlzYWJsZTogdHJ1ZSB9LFxyXG4gICAgICB7IGlkOiA1LCB0ZXh0OiAn7Y6Y7J207KeAIOyEpOyglShVKS4uLicsIGtleTogW10sIGRpc2FibGU6IHRydWUgfSxcclxuICAgICAgeyBpZDogNiwgdGV4dDogJ+yduOyHhChQKS4uLicsIGtleTogWydDdHJsJywgJ1AnXSwgZGlzYWJsZTogdHJ1ZSB9LFxyXG4gICAgICB7IGlkOiA3LCB0ZXh0OiAn64Gd64K06riwKFgpJywga2V5OiBbXSwgZGlzYWJsZTogdHJ1ZSB9LFxyXG4gICAgXSxcclxuICB9LFxyXG4gIHtcclxuICAgIGlkOiAnZWRpdCcsXHJcbiAgICB0aXRsZTogJ+2OuOynkScsXHJcbiAgICBrZXk6ICdFJyxcclxuICAgIHNsb3RzOiBbXHJcbiAgICAgIHsgaWQ6IDgsIHRleHQ6ICfsi6Ttlokg7Leo7IaMKFUpJywga2V5OiBbJ0N0cmwnLCAnWiddLCBkaXNhYmxlOiB0cnVlIH0sXHJcbiAgICAgIHsgaWQ6IDksIHRleHQ6ICfsnpjrnbzrgrTquLAoVCknLCBrZXk6IFsnQ3RybCcsICdYJ10sIGRpc2FibGU6IHRydWUgfSxcclxuICAgICAgeyBpZDogMTAsIHRleHQ6ICfrs7XsgqwoQyknLCBrZXk6IFsnQ3RybCcsICdDJ10sIGRpc2FibGU6IHRydWUgfSxcclxuICAgICAgeyBpZDogMTEsIHRleHQ6ICfrtpnsl6zrhKPquLAoUCknLCBrZXk6IFsnQ3RybCcsICdWJ10sIGRpc2FibGU6IHRydWUgfSxcclxuICAgICAgeyBpZDogMTIsIHRleHQ6ICfsgq3soJwoRCknLCBrZXk6IFsnRGVsJ10sIGRpc2FibGU6IHRydWUgfSxcclxuICAgICAgeyBpZDogMTMsIHRleHQ6ICdCaW5n7Jy866GcIOqygOyDiShTKS4uLicsIGtleTogWydDdHJsJywgJ0UnXSwgZGlzYWJsZTogdHJ1ZSB9LFxyXG4gICAgICB7IGlkOiAxNCwgdGV4dDogJ+ywvuq4sChGKS4uLicsIGtleTogWydDdHJsJywgJ0YnXSwgZGlzYWJsZTogdHJ1ZSB9LFxyXG4gICAgICB7IGlkOiAxNSwgdGV4dDogJ+uLpOydjCDssL7quLAoTiknLCBrZXk6IFsnRjMnXSwgZGlzYWJsZTogdHJ1ZSB9LFxyXG4gICAgICB7IGlkOiAxNiwgdGV4dDogJ+ydtOyghCDssL7quLAoViknLCBrZXk6IFsnU2hpZnQnLCAnRjMnXSwgZGlzYWJsZTogdHJ1ZSB9LFxyXG4gICAgICB7IGlkOiAxNywgdGV4dDogJ+uwlOq+uOq4sChSKS4uLicsIGtleTogWydDdHJsJywgJ0gnXSwgZGlzYWJsZTogdHJ1ZSB9LFxyXG4gICAgICB7IGlkOiAxOCwgdGV4dDogJ+ydtOuPmShHKS4uLicsIGtleTogWydDdHJsJywgJ0cnXSwgZGlzYWJsZTogdHJ1ZSB9LFxyXG4gICAgICB7IGlkOiAxOSwgdGV4dDogJ+uqqOuRkCDshKDtg50oQSknLCBrZXk6IFsnQ3RybCcsICdBJ10sIGRpc2FibGU6IHRydWUgfSxcclxuICAgICAgeyBpZDogMjAsIHRleHQ6ICfsi5zqsIQv64Kg7KecKEQpJywga2V5OiBbJ0Y1J10sIGRpc2FibGU6IHRydWUgfSxcclxuICAgIF0sXHJcbiAgfSxcclxuICB7XHJcbiAgICBpZDogJ2Zvcm1hdCcsXHJcbiAgICB0aXRsZTogJ+yEnOyLnScsXHJcbiAgICBrZXk6ICdPJyxcclxuICAgIHNsb3RzOiBbXHJcbiAgICAgIHsgaWQ6IDIxLCB0ZXh0OiAn7J6Q64+ZIOykhCDrsJTqv4goVyknLCBrZXk6IFtdLCBkaXNhYmxlOiB0cnVlIH0sXHJcbiAgICAgIHsgaWQ6IDIyLCB0ZXh0OiAn6riA6ry0KEYpLi4uJywga2V5OiBbXSwgZGlzYWJsZTogdHJ1ZSB9LFxyXG4gICAgXSxcclxuICB9LFxyXG4gIHtcclxuICAgIGlkOiAndmlldycsXHJcbiAgICB0aXRsZTogJ+uztOq4sCcsXHJcbiAgICBrZXk6ICdWJyxcclxuICAgIHNsb3RzOiBbXHJcbiAgICAgIHsgaWQ6IDIzLCB0ZXh0OiAn7ZmV64yA7ZWY6riwKFopJywga2V5OiBbJ0N0cmwnLCAnKyddLCBkaXNhYmxlOiB0cnVlIH0sXHJcbiAgICAgIHsgaWQ6IDI0LCB0ZXh0OiAn7LaV7IaM7ZWY6riwKFgpJywga2V5OiBbJ0N0cmwnLCAnLSddLCBkaXNhYmxlOiB0cnVlIH0sXHJcbiAgICAgIHsgaWQ6IDI1LCB0ZXh0OiAn7IOB7YOcIO2RnOyLnOykhChTKScsIGtleTogW10sIGRpc2FibGU6IHRydWUgfSxcclxuICAgIF0sXHJcbiAgfSxcclxuICB7XHJcbiAgICBpZDogJ2hlbHAnLFxyXG4gICAgdGl0bGU6ICfrj4Tsm4Drp5AnLFxyXG4gICAga2V5OiAnSCcsXHJcbiAgICBzbG90czogW1xyXG4gICAgICB7IGlkOiAyNiwgdGV4dDogJ+uPhOybgOunkCDrs7TquLAoSCknLCBrZXk6IFtdLCBkaXNhYmxlOiB0cnVlIH0sXHJcbiAgICAgIHsgaWQ6IDI3LCB0ZXh0OiAn7ZS865Oc67CxIOuztOuCtOq4sChGKScsIGtleTogW10sIGRpc2FibGU6IHRydWUgfSxcclxuICAgICAgeyBpZDogMjgsIHRleHQ6ICfrqZTrqqjsnqUg7KCV67O0KEEpJywga2V5OiBbXSwgZGlzYWJsZTogdHJ1ZSB9LFxyXG4gICAgXSxcclxuICB9LFxyXG5dO1xyXG5cclxuY29uc3Qgc2xvdHMgPSBidXR0b25zLnJlZHVjZSgoYWNjLCBjdXIpID0+IHtcclxuICByZXR1cm4gWy4uLmFjYywgLi4uY3VyLnNsb3RzXTtcclxufSwgW10pO1xyXG5cclxuZXhwb3J0IGRlZmF1bHQgYnV0dG9ucztcclxuZXhwb3J0IHsgc2xvdHMgfTtcclxuXHJcbmZ1bmN0aW9uIGhhbmRsZVNhdmVDbGljaygpIHtcclxuICB0aGlzLmRpc3BhdGNoRXZlbnQobmV3IEN1c3RvbUV2ZW50KCdzYXZlJywgeyBidWJibGVzOiB0cnVlIH0pKTtcclxufVxyXG5cclxuZnVuY3Rpb24gaGFuZGxlTG9jYWxTYXZlQ2xpY2soKSB7XHJcbiAgdGhpcy5kaXNwYXRjaEV2ZW50KG5ldyBDdXN0b21FdmVudCgnbG9jYWxTYXZlJywgeyBidWJibGVzOiB0cnVlIH0pKTtcclxufVxyXG4iLCJpbXBvcnQgeyBodG1sIH0gZnJvbSAnLi4vLi4vLi4vdXRpbHMvdXRpbHMnO1xyXG5pbXBvcnQgV2ViQ29tcG9uZW50IGZyb20gJy4uLy4uLy4uL2NvcmUvV2ViQ29tcG9uZW50JztcclxuaW1wb3J0IGJ1dHRvbnMsIHsgc2xvdHMgfSBmcm9tICcuLi9jb25zdC9idXR0b25zJztcclxuaW1wb3J0IE5vdGVQYWRJY29uIGZyb20gJy4uLy4uLy4uLy4uL3B1YmxpYy9ub3RlcGFkLnBuZyc7XHJcbmltcG9ydCByb3V0ZXIgZnJvbSAnLi4vLi4vLi4vY29yZS9Sb3V0ZXInO1xyXG5cclxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgTm90ZVBhZEhlYWRlciBleHRlbmRzIFdlYkNvbXBvbmVudCB7XHJcbiAgY29ubmVjdGVkQ2FsbGJhY2soKSB7XHJcbiAgICBzdXBlci5jb25uZWN0ZWRDYWxsYmFjaygpO1xyXG4gICAgdGhpcy5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIHRoaXMuaGFuZGxlQ2xpY2spO1xyXG4gIH1cclxuXHJcbiAgZGlzY29ubmVjdGVkQ2FsbGJhY2soKSB7XHJcbiAgICB0aGlzLnJlbW92ZUV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgdGhpcy5oYW5kbGVDbGljayk7XHJcbiAgfVxyXG5cclxuICBpbmplY3RIVE1MKCkge1xyXG4gICAgcmV0dXJuIGh0bWxgXHJcbiAgICAgIDxoZWFkZXI+XHJcbiAgICAgICAgPHNwYW4+PGltZyBhbHQ9XCJub3RlcGFkX2ljb25cIiBzcmM9JHtOb3RlUGFkSWNvbn0gLz7soJzrqqnsl4bsnYwgLSBXaW5kb3dzIOuplOuqqOyepTwvc3Bhbj5cclxuICAgICAgICA8ZGl2IGNsYXNzPVwidmlld19idXR0b25zXCI+XHJcbiAgICAgICAgICA8YnV0dG9uIGNsYXNzPVwidmlld19idXR0b25cIiBpZD1cIm1pbmlcIj7wn5eVPC9idXR0b24+XHJcbiAgICAgICAgICA8YnV0dG9uIGNsYXNzPVwidmlld19idXR0b25cIiBpZD1cImZ1bGxcIj7wn5eWPC9idXR0b24+XHJcbiAgICAgICAgICA8YnV0dG9uIGNsYXNzPVwidmlld19idXR0b25cIiBpZD1cImNsb3NlXCI+4oWpPC9idXR0b24+XHJcbiAgICAgICAgPC9kaXY+XHJcbiAgICAgIDwvaGVhZGVyPlxyXG4gICAgICA8ZGl2IGNsYXNzPVwiZWRpdF9idXR0b25zXCI+XHJcbiAgICAgICAgJHtidXR0b25zXHJcbiAgICAgICAgICAubWFwKFxyXG4gICAgICAgICAgICAoYnV0dG9uKSA9PiBodG1sYFxyXG4gICAgICAgICAgICAgIDxidXR0b24gY2xhc3M9XCJlZGl0X2J1dHRvblwiPlxyXG4gICAgICAgICAgICAgICAgJHtidXR0b24udGl0bGV9KDx1PiR7YnV0dG9uLmtleX08L3U+KVxyXG4gICAgICAgICAgICAgICAgPGRpdiBjbGFzcz1cInBvcHVwXCI+XHJcbiAgICAgICAgICAgICAgICAgICR7YnV0dG9uLnNsb3RzXHJcbiAgICAgICAgICAgICAgICAgICAgLm1hcChcclxuICAgICAgICAgICAgICAgICAgICAgIChzbG90KSA9PiBodG1sYFxyXG4gICAgICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPVwic3ViXCIgZGF0YS1pZD1cIiR7c2xvdC5pZH1cIiBkYXRhLWRpc2FibGU9XCIkeyEhc2xvdC5kaXNhYmxlfVwiPlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgIDxkaXY+JHtzbG90LnRleHR9PC9kaXY+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgJHtzbG90LmtleS5sZW5ndGggPiAwID8gYDxkaXY+JHtzbG90LmtleS5qb2luKCcgKyAnKX08L2Rpdj5gIDogJyd9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIDwvZGl2PlxyXG4gICAgICAgICAgICAgICAgICAgICAgYFxyXG4gICAgICAgICAgICAgICAgICAgIClcclxuICAgICAgICAgICAgICAgICAgICAuam9pbignJyl9XHJcbiAgICAgICAgICAgICAgICA8L2Rpdj5cclxuICAgICAgICAgICAgICA8L2J1dHRvbj5cclxuICAgICAgICAgICAgYFxyXG4gICAgICAgICAgKVxyXG4gICAgICAgICAgLmpvaW4oJycpfVxyXG4gICAgICA8L2Rpdj5cclxuICAgIGA7XHJcbiAgfVxyXG5cclxuICBoYW5kbGVDbGljayhlKSB7XHJcbiAgICBjb25zdCBzdWIgPSBlLnRhcmdldC5jbG9zZXN0KCcuc3ViJyk7XHJcbiAgICBpZiAoc3ViKSB7XHJcbiAgICAgIGNvbnN0IHNsb3RJZCA9IE51bWJlcihzdWIuZGF0YXNldC5pZCk7XHJcbiAgICAgIGNvbnN0IHsgb25DbGljayB9ID0gc2xvdHMuZmluZCgoc2xvdCkgPT4gc2xvdC5pZCA9PT0gc2xvdElkKSB8fCB7fTtcclxuICAgICAgaWYgKG9uQ2xpY2spIG9uQ2xpY2suY2FsbCh0aGlzKTtcclxuICAgICAgcmV0dXJuO1xyXG4gICAgfVxyXG5cclxuICAgIHN3aXRjaCAoZS50YXJnZXQuY2xhc3NOYW1lKSB7XHJcbiAgICAgIGNhc2UgJ3ZpZXdfYnV0dG9uJzpcclxuICAgICAgICBjbGlja1ZpZXdCdXR0b24uY2FsbCh0aGlzLCBlLnRhcmdldCk7XHJcbiAgICAgICAgYnJlYWs7XHJcbiAgICAgIGNhc2UgJ2VkaXRfYnV0dG9uJzpcclxuICAgICAgICBzaG93UG9wdXAuY2FsbCh0aGlzLCBlLnRhcmdldCk7XHJcbiAgICAgICAgYnJlYWs7XHJcbiAgICAgIGRlZmF1bHQ6XHJcbiAgICAgICAgYnJlYWs7XHJcbiAgICB9XHJcblxyXG4gICAgZnVuY3Rpb24gY2xpY2tWaWV3QnV0dG9uKHZUYXJnZXQpIHtcclxuICAgICAgc3dpdGNoICh2VGFyZ2V0LmlkKSB7XHJcbiAgICAgICAgY2FzZSAnZnVsbCc6XHJcbiAgICAgICAgICB0aGlzLnBhcmVudEVsZW1lbnQuY2xhc3NMaXN0LnRvZ2dsZSgnZnVsbHNjcmVlbicpO1xyXG4gICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgY2FzZSAnbWluaSc6XHJcbiAgICAgICAgY2FzZSAnY2xvc2UnOlxyXG4gICAgICAgICAgcm91dGVyLmJhY2soKTtcclxuICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgIGRlZmF1bHQ6XHJcbiAgICAgICAgICBicmVhaztcclxuICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIGZ1bmN0aW9uIHNob3dQb3B1cChlVGFyZ2V0KSB7XHJcbiAgICAgIGVUYXJnZXQucXVlcnlTZWxlY3RvcignLnBvcHVwJykuY2xhc3NMaXN0LnRvZ2dsZSgnc2hvdycpO1xyXG4gICAgICB0aGlzLnF1ZXJ5U2VsZWN0b3JBbGwoJy5wb3B1cCcpLmZvckVhY2goKG5vZGUpID0+IHtcclxuICAgICAgICBpZiAobm9kZSAhPT0gZVRhcmdldC5xdWVyeVNlbGVjdG9yKCcucG9wdXAnKSkge1xyXG4gICAgICAgICAgbm9kZS5jbGFzc0xpc3QucmVtb3ZlKCdzaG93Jyk7XHJcbiAgICAgICAgfVxyXG4gICAgICB9KTtcclxuICAgIH1cclxuICB9XHJcbn1cclxuIiwiaW1wb3J0ICcuL3N0eWxlLnNjc3MnO1xyXG5pbXBvcnQgc2FuZGJveERCIGZyb20gJy4vY29yZS9JbmRleGVkREInO1xyXG5pbXBvcnQgQXBwIGZyb20gJy4vQXBwJztcclxuaW1wb3J0IEZvb3RlciBmcm9tICcuL3ZpZXcvQ29tbW9uL0Zvb3Rlcic7XHJcbmltcG9ydCBIb21lIGZyb20gJy4vdmlldy9Ib21lJztcclxuaW1wb3J0IFRldHJpcyBmcm9tICcuL3ZpZXcvVGV0cmlzJztcclxuaW1wb3J0IEZsYXBweUJpcmQgZnJvbSAnLi92aWV3L0ZsYXBweUJpcmQnO1xyXG5pbXBvcnQgSWNvbnMgZnJvbSAnLi92aWV3L0NvbW1vbi9JY29ucyc7XHJcbmltcG9ydCBJY29uIGZyb20gJy4vdmlldy9Db21tb24vSWNvbic7XHJcbmltcG9ydCBOb3RlUGFkIGZyb20gJy4vdmlldy9Ob3RlUGFkJztcclxuaW1wb3J0IE5vdGVQYWRIZWFkZXIgZnJvbSAnLi92aWV3L05vdGVQYWQvY29tcG9uZW50cy9Ob3RlUGFkSGVhZGVyJztcclxuaW1wb3J0IHJvdXRlciBmcm9tICcuL2NvcmUvUm91dGVyJztcclxuXHJcbihhc3luYyAoKSA9PiB7XHJcbiAgYXdhaXQgc2FuZGJveERCLm9wZW5EQigpO1xyXG5cclxuICBjdXN0b21FbGVtZW50cy5kZWZpbmUoJ215LWFwcCcsIEFwcCk7XHJcbiAgY3VzdG9tRWxlbWVudHMuZGVmaW5lKCdteS1mb290ZXInLCBGb290ZXIpO1xyXG4gIGN1c3RvbUVsZW1lbnRzLmRlZmluZSgnbXktaG9tZScsIEhvbWUpO1xyXG4gIGN1c3RvbUVsZW1lbnRzLmRlZmluZSgnbXktdGV0cmlzJywgVGV0cmlzKTtcclxuICBjdXN0b21FbGVtZW50cy5kZWZpbmUoJ215LWZsYXBweWJpcmQnLCBGbGFwcHlCaXJkKTtcclxuICBjdXN0b21FbGVtZW50cy5kZWZpbmUoJ215LWljb25zJywgSWNvbnMpO1xyXG4gIGN1c3RvbUVsZW1lbnRzLmRlZmluZSgnbXktaWNvbicsIEljb24pO1xyXG4gIGN1c3RvbUVsZW1lbnRzLmRlZmluZSgnbXktbm90ZXBhZCcsIE5vdGVQYWQpO1xyXG4gIGN1c3RvbUVsZW1lbnRzLmRlZmluZSgnbXktbm90ZXBhZC1oZWFkZXInLCBOb3RlUGFkSGVhZGVyKTtcclxufSkoKTtcclxuXHJcbndpbmRvdy5hZGRFdmVudExpc3RlbmVyKCdwb3BzdGF0ZScsICgpID0+IHJvdXRlci5yZW5kZXIoKSk7XHJcbiJdLCJuYW1lcyI6WyJfX3dlYnBhY2tfcmVxdWlyZV9fIiwiZGIiLCJjb25zdHJ1Y3RvciIsImRiTmFtZSIsImRiVmVyc2lvbiIsInN0b3JlcyIsInRoaXMiLCJhc3luYyIsIlByb21pc2UiLCJyZXNvbHZlIiwicmVqZWN0IiwicmVxdWVzdCIsIndpbmRvdyIsImluZGV4ZWREQiIsIm9wZW4iLCJvbnN1Y2Nlc3MiLCJyZXN1bHQiLCJvbmVycm9yIiwiZSIsIm9udXBncmFkZW5lZWRlZCIsImZvckVhY2giLCJzdG9yZSIsIm9iamVjdFN0b3JlTmFtZXMiLCJjb250YWlucyIsImRlbGV0ZU9iamVjdFN0b3JlIiwiY3JlYXRlT2JqZWN0U3RvcmUiLCJrZXlQYXRoIiwiYXV0b0luY3JlbWVudCIsInN0b3JlTmFtZSIsImlkIiwidHJhbnNhY3Rpb24iLCJvYmplY3RTdG9yZSIsImdldCIsImdldEFsbCIsImRhdGEiLCJwdXQiLCJkZWxldGUiLCJyZW5kZXJSYXciLCJzdHJpbmciLCJ2YWx1ZXMiLCJTdHJpbmciLCJyYXciLCJXZWJDb21wb25lbnQiLCJIVE1MRWxlbWVudCIsImNvbm5lY3RlZENhbGxiYWNrIiwicmVuZGVyIiwiaW5uZXJIVE1MIiwiaW5qZWN0SFRNTCIsIkFwcCIsInJvdXRlcyIsInBhdGgiLCJodG1sIiwibGFiZWwiLCJpY29uU3JjIiwibWFpbkljb25zIiwicmVkdWNlIiwicHJldiIsInJvdXRlciIsImdldExvY2FsSWNvbnMiLCJpY29uIiwidGl0bGUiLCJCQVNFX1VSTCIsInJvdXRlIiwiZmluZCIsInZhbHVlIiwibG9jYXRpb24iLCJwYXRobmFtZSIsInJlcGxhY2UiLCJkb2N1bWVudCIsInF1ZXJ5U2VsZWN0b3IiLCJyZXBsYWNlVG8iLCJuYXZpZ2F0ZVRvIiwidXJsIiwiaGlzdG9yeSIsInB1c2hTdGF0ZSIsInJlcGxhY2VTdGF0ZSIsImJhY2siLCJGb290ZXIiLCJzdXBlciIsImFkZEV2ZW50TGlzdGVuZXIiLCJoYW5kbGVDbGljayIsImJpbmQiLCJqb2luIiwidGFyZ2V0IiwiY2xvc2VzdCIsImRhdGFzZXQiLCJIb21lIiwiVGV0cmlzIiwiRmxhcHB5QmlyZCIsIkljb25zIiwiaWNvbnMiLCJoYW5kbGVEb3VibGVDbGljayIsImhhbmRsZUtleURvd24iLCJkZXRhaWwiLCJvYnNlcnZlZEF0dHJpYnV0ZXMiLCJhdHRyaWJ1dGVDaGFuZ2VkQ2FsbGJhY2siLCJuYW1lIiwib2xkVmFsdWUiLCJuZXdWYWx1ZSIsIm1hcCIsIkpTT04iLCJwYXJzZSIsImdldEF0dHJpYnV0ZSIsInNldEF0dHJpYnV0ZSIsInN0cmluZ2lmeSIsInRvZ2dsZUF0dHJpYnV0ZSIsInF1ZXJ5U2VsZWN0b3JBbGwiLCJub2RlIiwicmVtb3ZlQXR0cmlidXRlIiwiY2hlY2tlZEVsIiwia2V5IiwibGVuZ3RoIiwiSWNvbiIsImljb25zcmMiLCJOb3RlUGFkIiwiaGFuZGxlU2F2ZSIsImhhbmRsZUxvY2FsU2F2ZSIsImRpc2Nvbm5lY3RlZENhbGxiYWNrIiwicmVtb3ZlRXZlbnRMaXN0ZW5lciIsIm5vdGVQYWREYXRhIiwiZ2V0Tm90ZVBhZERhdGEiLCJibG9iIiwiQmxvYiIsImNvbnRlbnQiLCJ0eXBlIiwibGluayIsImNyZWF0ZUVsZW1lbnQiLCJocmVmIiwiVVJMIiwiY3JlYXRlT2JqZWN0VVJMIiwiZG93bmxvYWQiLCJjbGljayIsImVyciIsImFsZXJ0IiwiY29uc29sZSIsImVycm9yIiwic3RvcFByb3BhZ2F0aW9uIiwiZGlzcGF0Y2hFdmVudCIsIkN1c3RvbUV2ZW50IiwicHJvbXB0IiwiYnV0dG9ucyIsInNsb3RzIiwidGV4dCIsImRpc2FibGUiLCJvbkNsaWNrIiwiYnViYmxlcyIsImFjYyIsImN1ciIsIk5vdGVQYWRIZWFkZXIiLCJidXR0b24iLCJzbG90Iiwic3ViIiwic2xvdElkIiwiTnVtYmVyIiwiY2FsbCIsImNsYXNzTmFtZSIsInZUYXJnZXQiLCJwYXJlbnRFbGVtZW50IiwiY2xhc3NMaXN0IiwidG9nZ2xlIiwiZVRhcmdldCIsInJlbW92ZSIsImN1c3RvbUVsZW1lbnRzIiwiZGVmaW5lIl0sInNvdXJjZVJvb3QiOiIifQ==